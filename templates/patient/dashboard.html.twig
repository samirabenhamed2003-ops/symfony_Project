{% extends 'dashboard_base.html.twig' %}

{% block title %}Mon Dashboard{% endblock %}

{% block page_title %}Mon Dashboard{% endblock %}

{% block sidebar_menu %}
    <a href="{{ path('patient_dashboard') }}" class="menu-item active">
        <i class="bi bi-calendar-check"></i>
        <span>Mes Rendez-vous</span>
    </a>
    <a href="{{ path('app_home') }}" class="menu-item">
        <i class="bi bi-house"></i>
        <span>Accueil</span>
    </a>
{% endblock %}

{% block body %}
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h5 class="mb-0">Mes Rendez-vous</h5>
            <p class="text-muted mb-0">Gérez vos rendez-vous médicaux</p>
        </div>
        <a href="{{ path('app_rendez_vous') }}" class="btn btn-primary">
            <i class="bi bi-plus-circle"></i> Nouveau rendez-vous
        </a>
    </div>

    {% if mes_rendez_vous is empty %}
        <div class="card shadow-sm">
            <div class="card-body text-center py-5">
                <i class="bi bi-calendar-x fs-1 text-muted"></i>
                <p class="text-muted mt-3">Vous n'avez aucun rendez-vous pour le moment.</p>
                <a href="{{ path('app_rendez_vous') }}" class="btn btn-primary">
                    <i class="bi bi-plus-circle"></i> Prendre un rendez-vous
                </a>
            </div>
        </div>
    {% else %}
     <div class="row">
    {% for rdv in mes_rendez_vous %}
        <div class="col-md-6 mb-4">
            <div class="card rdv-card h-100">
                <div class="card-body">
                    <div class="d-flex justify-content-between mb-3">
                        <span class="rdv-date">
                            {{ rdv.dateRdv|date('d/m/Y') }} – {{ rdv.heureRdv|date('H:i') }}
                        </span>

                        <span class="rdv-status
                            {% if rdv.statut == 'valide' %} bg-success text-white
                            {% elseif rdv.statut == 'en_attente' %} bg-warning text-dark
                            {% elseif rdv.statut == 'refuse' %} bg-danger text-white
                            {% endif %}
                        ">
                            {{ rdv.statut|replace({'_':' '})|capitalize }}
                        </span>
                    </div>

                    <p class="mb-2">
                        <i class="bi bi-person-badge"></i>
                        <strong>Médecin :</strong> {{ rdv.medecin.email ?? '—' }}
                    </p>

                    <p class="mb-3">
                        <i class="bi bi-heart-pulse"></i>
                        <strong>Spécialité :</strong> {{ rdv.specialite }}
                    </p>

                    <a href="{{ path('patient_rdv_detail', {id: rdv.id}) }}"
                       class="btn btn-outline-primary btn-sm">
                        <i class="bi bi-eye"></i> Voir détails
                    </a>
                </div>
            </div>
        </div>
    {% endfor %}
</div>

    {% endif %}
{% endblock %}
